<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Editar Producto</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
  <style>
    .flatpickr-today-btn {
      background-color: #0d6efd;
      border: none;
      color: white;
      cursor: pointer;
      border-radius: 3px;
      font-weight: bold;
      margin: 5px;
      padding: 5px 10px;
      align-self: center;
    }
    .flatpickr-today-btn:hover {
      background-color: #0b5ed7;
    }
  </style>
</head>
<body class="bg-light">
  <div class="container mt-4">
    <h2 class="mb-4 text-center">Editar Producto</h2>

    <form method="POST">
      <div class="row g-3">

        <div class="col-md-6">
          <label class="form-label">LOT</label>
          <input type="text" class="form-control" name="LOT" value="{{ producto['LOT'] }}" required>
        </div>
        <div class="col-md-6">
          <label class="form-label">List Number</label>
          <input type="text" class="form-control" name="list_number" value="{{ producto['ListNumber'] }}">
        </div>

        <div class="col-md-6">
          <label class="form-label">Descripción</label>
          <input type="text" class="form-control" name="description" value="{{ producto['Description'] }}" required>
        </div>
        <div class="col-md-6">
          <label class="form-label">Product Type</label>
          <input type="text" class="form-control" name="product_type" value="{{ producto['Product_Type'] }}">
        </div>

        <div class="col-md-6">
          <label class="form-label">Located</label>
          <input type="text" class="form-control" name="located" value="{{ producto['Located'] }}">
        </div>

        <div class="col-md-6">
          <label class="form-label">Date-In</label>
          <input type="date" class="form-control" name="Date_In" id="Date_In" 
                 value="{{ producto['Date_In'] | default('') }}" max="">
        </div>

        <div class="col-md-6">
          <label class="form-label">QTY Vol</label>
          <input type="number" class="form-control" name="QTY_Vol" value="{{ producto['QTY_Vol'] }}" readonly>
        </div>

        <div class="col-md-4">
          <label class="form-label">Unit</label>
          <input type="text" class="form-control" name="Unit" value="{{ producto['Unit'] }}" required>
        </div>

        <div class="col-md-4">
          <label class="form-label">STOCK</label>
          <input type="number" step="0.01" class="form-control" name="stock" value="{{ producto['STOCK'] }}" required>
         
          
        </div>

        <div class="col-md-4">
          <label class="form-label">Qty Per Box</label>
          <input type="number" step="0.01" class="form-control" name="Qty_Per_Box" value="{{ producto['Qty_Per_Box'] }}" required>
        </div>

        <div class="col-md-4">
          <label class="form-label">Box Available</label>
          <input type="number" step="0.01" class="form-control" name="Box_Available" value="{{ producto['Box_Available'] }}" readonly>
          <div class="form-text text-warning">
    ⚠ Este campo es calculado y no puede ser editado.
  </div>
        </div>

        <div class="col-md-4">
          <label class="form-label">Maximum Storage Days</label>
          <input type="number" step="0.01" class="form-control" name="Maximum_Storage_Days" value="{{ producto['Maximum _Storage (Days)'] }}" required>
          <div class="form-text text-warning">
    ⚠ Este campo es calculado y no puede ser editado.
  </div>
        </div>

        <div class="col-md-6">
          <label class="form-label">Material Agregado</label>
          <input type="number" name="add" class="form-control" value="0">
        </div>

         <div class="col-md-6">
          <label class="form-label">Material Consumido</label>
          <input type="number" name="lower" class="form-control" value="0">
        </div>

       

          <!-- Nuevos campos agregados -->

           <div class="col-md-6">
          <label class="form-label">Due Date</label>
          <input type="date" name="Due_Date" class="form-control" value="{{ producto['Due_Date'] }}">
        </div>

         <div class="col-md-6">
          <label class="form-label">Days Available</label>
          <input type="number" name="Days_Available" class="form-control" value="{{ producto['Days_Available'] }}" readonly>
        </div>

         <div class="col-md-6">
          <label class="form-label">Status</label>
          <input type="text" name="Status" class="form-control" value="{{ producto['Status'] }}">
        </div>

         <div class="col-md-6">
          <label class="form-label">Note</label>
          <input type="text" name="Note" class="form-control" value="{{ producto['Note'] }}">
        </div>



      </div>

      <div class="mt-4 d-flex justify-content-between">
        <a href="/inventario" class="btn btn-secondary">Cancelar</a>
        <button type="submit" class="btn btn-primary">Guardar cambios</button>
      </div>
    </form>
  </div>

  <script>
    document.addEventListener("DOMContentLoaded", function () {
      const today = new Date().toISOString().split("T")[0];
      const dateInput = document.getElementById("Date_In");
      dateInput.max = today;
    });
  </script>

<!-- calculo de Box_Available -->
<script>
document.addEventListener("DOMContentLoaded", function () {
    const stockInput = document.querySelector('input[name="stock"]');
    const qtyPerBoxInput = document.querySelector('input[name="Qty_Per_Box"]');
    const boxAvailableInput = document.querySelector('input[name="Box_Available"]');

    function calcularBoxAvailable() {
        const stock = parseFloat(stockInput.value) || 0;
        const qtyPerBox = parseFloat(qtyPerBoxInput.value) || 0;
        if (qtyPerBox > 0) {
            boxAvailableInput.value = (stock / qtyPerBox).toFixed(1);
        } else {
            boxAvailableInput.value = 0;
        }
    }

    stockInput.addEventListener("input", calcularBoxAvailable);
    qtyPerBoxInput.addEventListener("input", calcularBoxAvailable);

    // Calcular al cargar la página con valores existentes
    calcularBoxAvailable();
});
</script>



</body>
</html>
